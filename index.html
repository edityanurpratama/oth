<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Klasifikasi Beasiswa - MP3 Kelompok 02</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .modal { display: none; }
        .modal.active { display: flex; }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl font-bold mb-2">üéì Sistem Klasifikasi Beasiswa</h1>
            <p class="opacity-90">MP3 Kelompok 02 - Kelas 5D | Machine Learning</p>
            <div class="mt-4 flex space-x-8">
                <div class="text-center">
                    <div class="text-2xl font-bold" id="nb-accuracy">85.0%</div>
                    <div class="text-sm opacity-80">Naive Bayes</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold" id="knn-accuracy">90.0%</div>
                    <div class="text-sm opacity-80">K-NN</div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto">
        <!-- Navigation Tabs -->
        <div class="flex border-b border-gray-200 bg-white">
            <button onclick="showTab('overview')" class="tab-btn py-4 px-6 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                üìä Overview
            </button>
            <button onclick="showTab('dataset')" class="tab-btn py-4 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                üìö Dataset
            </button>
            <button onclick="showTab('naivebayes')" class="tab-btn py-4 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                üß† Naive Bayes
            </button>
            <button onclick="showTab('knn')" class="tab-btn py-4 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                üéØ K-NN
            </button>
            <button onclick="showTab('comparison')" class="tab-btn py-4 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                ‚öñÔ∏è Perbandingan
            </button>
            <button onclick="showTab('download')" class="tab-btn py-4 px-6 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm">
                üì• Export
            </button>
        </div>

        <!-- Content -->
        <div class="p-6 bg-white min-h-96">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4">Naive Bayes</h3>
                            <div class="text-3xl font-bold text-blue-600">85.0%</div>
                            <p class="text-blue-700">Akurasi Training</p>
                        </div>
                        <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                            <h3 class="text-lg font-semibold text-green-800 mb-4">K-NN</h3>
                            <div class="text-3xl font-bold text-green-600">90.0%</div>
                            <p class="text-green-700">Akurasi Training</p>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">üìä Ringkasan Dataset</h3>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div>
                                <div class="text-2xl font-bold text-gray-800">20</div>
                                <div class="text-gray-600">Total Mahasiswa</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-green-600">12</div>
                                <div class="text-gray-600">Dapat Beasiswa</div>
                            </div>
                            <div>
                                <div class="text-2xl font-bold text-red-600">8</div>
                                <div class="text-gray-600">Tidak Dapat</div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="showTab('naivebayes')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-colors">
                            ‚ñ∂Ô∏è Test Naive Bayes
                        </button>
                        <button onclick="showTab('knn')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-colors">
                            ‚ñ∂Ô∏è Test K-NN
                        </button>
                        <button onclick="showTab('download')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-colors">
                            üìÑ Export Laporan
                        </button>
                    </div>

                    <div id="predictions-log" class="bg-white p-6 rounded-lg border" style="display: none;">
                        <h3 class="text-lg font-semibold mb-4">üìù Prediksi Terakhir</h3>
                        <div id="predictions-list" class="space-y-2"></div>
                    </div>
                </div>
            </div>

            <!-- Dataset Tab -->
            <div id="dataset" class="tab-content">
                <h2 class="text-2xl font-bold mb-6">üìä Dataset Lengkap</h2>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="border border-gray-300 px-4 py-2">No</th>
                                <th class="border border-gray-300 px-4 py-2">IPK Kategori</th>
                                <th class="border border-gray-300 px-4 py-2">Pendapatan</th>
                                <th class="border border-gray-300 px-4 py-2">Organisasi</th>
                                <th class="border border-gray-300 px-4 py-2">IPK Numerik</th>
                                <th class="border border-gray-300 px-4 py-2">Pendapatan (Juta)</th>
                                <th class="border border-gray-300 px-4 py-2">Skor Organisasi</th>
                                <th class="border border-gray-300 px-4 py-2">Beasiswa</th>
                            </tr>
                        </thead>
                        <tbody id="dataset-table">
                            <!-- Data akan diisi dengan JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Naive Bayes Tab -->
            <div id="naivebayes" class="tab-content">
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold">üß† Naive Bayes Classifier</h2>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <div class="text-lg font-bold text-blue-800">0.60</div>
                            <div class="text-blue-600">P(Ya)</div>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg text-center">
                            <div class="text-lg font-bold text-red-800">0.40</div>
                            <div class="text-red-600">P(Tidak)</div>
                        </div>
                    </div>

                    <form onsubmit="handleNBPrediction(event)" class="space-y-4 bg-gray-50 p-6 rounded-lg">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IPK Kategori</label>
                            <select name="ipk" required class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="Tinggi">Tinggi</option>
                                <option value="Sedang">Sedang</option>
                                <option value="Rendah">Rendah</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pendapatan Keluarga</label>
                            <select name="pendapatan" required class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="Rendah">Rendah</option>
                                <option value="Sedang">Sedang</option>
                                <option value="Tinggi">Tinggi</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Aktivitas Organisasi</label>
                            <select name="organisasi" required class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="Aktif">Aktif</option>
                                <option value="Tidak Aktif">Tidak Aktif</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-colors font-medium">
                            Klasifikasi dengan Naive Bayes
                        </button>
                    </form>
                </div>
            </div>

            <!-- K-NN Tab -->
            <div id="knn" class="tab-content">
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold">üéØ K-Nearest Neighbor</h2>
                    
                    <form onsubmit="handleKNNPrediction(event)" class="space-y-4 bg-gray-50 p-6 rounded-lg">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nilai K</label>
                            <select name="k" required class="w-full p-3 border border-gray-300 rounded-lg">
                                <option value="3">K = 3</option>
                                <option value="5">K = 5</option>
                                <option value="7">K = 7</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">IPK (0.0 - 4.0)</label>
                            <input type="number" name="ipkNum" min="0" max="4" step="0.1" value="3.5" required class="w-full p-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pendapatan (Juta Rupiah)</label>
                            <input type="number" name="pendapatanNum" min="1" max="20" value="5" required class="w-full p-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Skor Organisasi (1-10)</label>
                            <input type="number" name="skorOrg" min="1" max="10" value="5" required class="w-full p-3 border border-gray-300 rounded-lg">
                        </div>
                        
                        <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-colors font-medium">
                            Klasifikasi dengan K-NN
                        </button>
                    </form>
                </div>
            </div>

            <!-- Comparison Tab -->
            <div id="comparison" class="tab-content">
                <h2 class="text-2xl font-bold mb-6">‚öñÔ∏è Perbandingan Model</h2>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="border border-gray-300 px-4 py-2 text-left">Aspek</th>
                                <th class="border border-gray-300 px-4 py-2">Naive Bayes</th>
                                <th class="border border-gray-300 px-4 py-2">K-NN</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2 font-medium">Akurasi Training</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">85.0%</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">90.0%</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2 font-medium">Kecepatan Prediksi</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Cepat</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Sedang</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2 font-medium">Penggunaan Memori</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Rendah</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Tinggi</td>
                            </tr>
                            <tr>
                                <td class="border border-gray-300 px-4 py-2 font-medium">Jenis Data Optimal</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Kategorikal</td>
                                <td class="border border-gray-300 px-4 py-2 text-center">Numerik</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Download Tab -->
            <div id="download" class="tab-content">
                <div class="space-y-6">
                    <h2 class="text-2xl font-bold">üì• Export Laporan</h2>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-blue-600">85.0%</div>
                            <div class="text-blue-800">Akurasi NB</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-green-600">90.0%</div>
                            <div class="text-green-800">Akurasi KNN</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-purple-600" id="total-predictions">0</div>
                            <div class="text-purple-800">Total Prediksi</div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg text-center">
                            <div class="text-2xl font-bold text-orange-600">20</div>
                            <div class="text-orange-800">Data Training</div>
                        </div>
                    </div>

                    <div class="bg-white p-6 border rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">üìÑ Format Export</h3>
                        <button onclick="generateReport()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors">
                            üìÑ Download TXT Report
                        </button>
                    </div>

                    <div id="export-predictions-log" class="bg-white p-6 border rounded-lg" style="display: none;">
                        <h3 class="text-lg font-semibold mb-4">üìä Log Prediksi</h3>
                        <div id="export-predictions-list" class="space-y-2 max-h-64 overflow-y-auto"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prediction Result Modal -->
    <div id="prediction-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg p-6 max-w-md w-full max-h-96 overflow-y-auto">
            <div class="text-center mb-4">
                <div class="text-4xl mb-2" id="modal-emoji">üéâ</div>
                <h3 class="text-xl font-bold" id="modal-title">Hasil Prediksi</h3>
            </div>

            <div class="space-y-4">
                <div id="modal-input"></div>

                <div class="text-center p-4 bg-gray-50 rounded-lg">
                    <div class="text-xl font-bold" id="modal-result">LAYAK</div>
                    <div class="text-sm text-gray-600">Mendapat Beasiswa</div>
                    <div class="text-sm mt-2" id="modal-confidence">Confidence: 85.0%</div>
                </div>

                <div id="modal-details"></div>
            </div>

            <div class="mt-6">
                <button onclick="closeModal()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition-colors">
                    Tutup
                </button>
            </div>
        </div>
    </div>

    <script>
        // Dataset
        const dataset = [
            { no: 1, ipk: 'Tinggi', pendapatan: 'Rendah', organisasi: 'Aktif', ipk_num: 3.8, pendapatan_num: 3, skor_org: 8, beasiswa: 'Ya' },
            { no: 2, ipk: 'Tinggi', pendapatan: 'Rendah', organisasi: 'Tidak Aktif', ipk_num: 3.7, pendapatan_num: 4, skor_org: 2, beasiswa: 'Ya' },
            { no: 3, ipk: 'Sedang', pendapatan: 'Rendah', organisasi: 'Aktif', ipk_num: 3.2, pendapatan_num: 3, skor_org: 7, beasiswa: 'Ya' },
            { no: 4, ipk: 'Tinggi', pendapatan: 'Sedang', organisasi: 'Aktif', ipk_num: 3.6, pendapatan_num: 7, skor_org: 8, beasiswa: 'Ya' },
            { no: 5, ipk: 'Sedang', pendapatan: 'Rendah', organisasi: 'Tidak Aktif', ipk_num: 3.1, pendapatan_num: 4, skor_org: 3, beasiswa: 'Tidak' },
        ];

        let predictions = [];

        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');

            // Mark button as active
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
        }

        // Initialize dataset table
        function initDatasetTable() {
            const tableBody = document.getElementById('dataset-table');
            tableBody.innerHTML = '';

            dataset.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = 'hover:bg-gray-50';
                tr.innerHTML = `
                    <td class="border border-gray-300 px-4 py-2 text-center">${row.no}</td>
                    <td class="border border-gray-300 px-4 py-2">${row.ipk}</td>
                    <td class="border border-gray-300 px-4 py-2">${row.pendapatan}</td>
                    <td class="border border-gray-300 px-4 py-2">${row.organisasi}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${row.ipk_num}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${row.pendapatan_num}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">${row.skor_org}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <span class="px-2 py-1 rounded text-xs ${row.beasiswa === 'Ya' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${row.beasiswa}
                        </span>
                    </td>
                `;
                tableBody.appendChild(tr);
            });
        }

        // Naive Bayes Calculator
        function calculateNaiveBayes(ipk, pendapatan, organisasi) {
            const priors = { 'Ya': 0.6, 'Tidak': 0.4 };
            const likelihoods = {
                'Ya': {
                    ipk: { 'Tinggi': 0.73, 'Sedang': 0.27, 'Rendah': 0.1 },
                    pendapatan: { 'Rendah': 0.6, 'Sedang': 0.3, 'Tinggi': 0.1 },
                    organisasi: { 'Aktif': 0.8, 'Tidak Aktif': 0.2 }
                },
                'Tidak': {
                    ipk: { 'Tinggi': 0.1, 'Sedang': 0.33, 'Rendah': 0.56 },
                    pendapatan: { 'Rendah': 0.25, 'Sedang': 0.37, 'Tinggi': 0.38 },
                    organisasi: { 'Aktif': 0.62, 'Tidak Aktif': 0.38 }
                }
            };

            const yaProb = priors['Ya'] * 
                likelihoods['Ya'].ipk[ipk] * 
                likelihoods['Ya'].pendapatan[pendapatan] * 
                likelihoods['Ya'].organisasi[organisasi];

            const tidakProb = priors['Tidak'] * 
                likelihoods['Tidak'].ipk[ipk] * 
                likelihoods['Tidak'].pendapatan[pendapatan] * 
                likelihoods['Tidak'].organisasi[organisasi];

            return {
                prediction: yaProb > tidakProb ? 'Ya' : 'Tidak',
                yaProb: yaProb,
                tidakProb: tidakProb,
                confidence: Math.max(yaProb, tidakProb) / (yaProb + tidakProb)
            };
        }

        // K-NN Calculator
        function calculateKNN(ipkNum, pendapatanNum, skorOrg, k = 3) {
            const distances = dataset.map(row => ({
                ...row,
                distance: Math.sqrt(
                    Math.pow(ipkNum - row.ipk_num, 2) + 
                    Math.pow(pendapatanNum - row.pendapatan_num, 2) + 
                    Math.pow(skorOrg - row.skor_org, 2)
                )
            })).sort((a, b) => a.distance - b.distance).slice(0, k);

            const votes = distances.reduce((acc, item) => {
                acc[item.beasiswa] = (acc[item.beasiswa] || 0) + 1;
                return acc;
            }, {});

            const prediction = Object.keys(votes).reduce((a, b) => votes[a] > votes[b] ? a : b);
            
            return {
                prediction,
                neighbors: distances,
                votes,
                confidence: Math.max(...Object.values(votes)) / k
            };
        }

        // Handle Naive Bayes Prediction
        function handleNBPrediction(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const ipk = formData.get('ipk');
            const pendapatan = formData.get('pendapatan');
            const organisasi = formData.get('organisasi');

            const result = calculateNaiveBayes(ipk, pendapatan, organisasi);
            
            const predText = `NB: IPK ${ipk}, Pendapatan ${pendapatan}, Organisasi ${organisasi} ‚Üí ${result.prediction}`;
            predictions.push(predText);
            
            showPredictionModal('Naive Bayes', { ipk, pendapatan, organisasi }, result);
            updatePredictionsList();
        }

        // Handle K-NN Prediction
        function handleKNNPrediction(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const ipkNum = parseFloat(formData.get('ipkNum'));
            const pendapatanNum = parseInt(formData.get('pendapatanNum'));
            const skorOrg = parseInt(formData.get('skorOrg'));
            const k = parseInt(formData.get('k'));

            const result = calculateKNN(ipkNum, pendapatanNum, skorOrg, k);
            
            const predText = `KNN(K=${k}): IPK ${ipkNum}, Pendapatan ${pendapatanNum}jt, Organisasi ${skorOrg} ‚Üí ${result.prediction}`;
            predictions.push(predText);
            
            showPredictionModal('K-NN', { ipkNum, pendapatanNum, skorOrg, k }, result);
            updatePredictionsList();
        }

        // Show Prediction Modal
        function showPredictionModal(type, input, result) {
            const modal = document.getElementById('prediction-modal');
            const emoji = document.getElementById('modal-emoji');
            const title = document.getElementById('modal-title');
            const inputDiv = document.getElementById('modal-input');
            const resultDiv = document.getElementById('modal-result');
            const confidence = document.getElementById('modal-confidence');
            const details = document.getElementById('modal-details');

            emoji.textContent = result.prediction === 'Ya' ? 'üéâ' : '‚ùå';
            title.textContent = `Hasil Prediksi ${type}`;
            
            if (type === 'Naive Bayes') {
                inputDiv.innerHTML = `
                    <h4 class="font-semibold">Input:</h4>
                    <div class="text-sm space-y-1">
                        <div>IPK: ${input.ipk}</div>
                        <div>Pendapatan: ${input.pendapatan}</div>
                        <div>Organisasi: ${input.organisasi}</div>
                    </div>
                `;
                details.innerHTML = `
                    <div>
                        <h4 class="font-semibold">Probabilitas:</h4>
